= Guide

This guide shows how to install, configure, and run the Neo4j Code Graph pipeline.

== Installation

[source,bash]
----
git clone https://github.com/alexwoolford/neo4j-code-graph
cd neo4j-code-graph
pip install -e '.[dev]'
----

== Configuration

Use environment variables or a `.env` file.

[source,bash]
----
NEO4J_URI=bolt://localhost:7687
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=your_password
NEO4J_DATABASE=neo4j

# Optional (recommended) for faster CVE analysis
NVD_API_KEY=your_nvd_api_key

# Optional similarity defaults (overridable by CLI flags)
SIMILARITY_TOP_K=5
SIMILARITY_CUTOFF=0.8
----

Tips:
- `.env` is discovered via `find_dotenv()`.
- CLI args override env values.

== Pipeline stages (overview)

* Code analysis
* Git history ingestion
* Similarity and centrality calculations
* CVE analysis
* Temporal coupling

== Run the pipeline

[source,bash]
----
# Console script
code-graph-pipeline-prefect --repo-url https://github.com/your-org/your-repo

# Or run the module directly
python -m src.pipeline.prefect_flow --repo-url https://github.com/your-org/your-repo
----

== Monitor runs with Prefect UI

Run the Prefect UI in a separate terminal to watch progress in real time, then start the pipeline.

[source,bash]
----
# Terminal 1: start Prefect UI locally
prefect server start
# UI: http://127.0.0.1:4200

# Terminal 2: run the pipeline
python -m src.pipeline.prefect_flow --repo-url https://github.com/your-org/your-repo
----

Below is an example DAG view of this pipeline:

image::prefect-dag.png[Prefect pipeline DAG,align=center]

== Query your data

Open Neo4j Browser or Bloom and run queries from the xref:queries/index.adoc[Queries catalog].
